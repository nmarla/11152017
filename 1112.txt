@using CTSImp1.ViewModels;
@using CTSImp1.Models;
@model TrackingViewModel
@{
    ViewBag.Title = "Tracking";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<head>
    <title>TinyMCE Example</title>
    <!-- TinyMCE Script Reference -->
    <script src="~/scripts/tinymce/tinymce.min.js"></script>
    <!-- Script to wire up your TinyMCE editor -->
    <script type="text/javascript">
        // Initialize your tinyMCE Editor with your preferred options
        tinyMCE.init({
            // General options
            mode: "textareas",
            theme: "modern",
            // Theme options
            theme_advanced_buttons1: "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect,fontselect,fontsizeselect",
            theme_advanced_buttons2: "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
            theme_advanced_buttons3: "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
            theme_advanced_buttons4: "insertlayer,moveforward,movebackward,absolute,|,styleprops,spellchecker,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,blockquote,pagebreak,|,insertfile,insertimage",
            theme_advanced_toolbar_location: "top",
            theme_advanced_toolbar_align: "left",
            theme_advanced_statusbar_location: "bottom",
            theme_advanced_resizing: true,

            // Example content CSS (should be your site CSS)
            // content_css: "css/example.css",
        });
    </script>
</head>
<body>
    @using (Html.BeginForm("TrackingInfo", "Tracking", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <div class="container ">
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblTktno", "Ticket No. / Complaint No.:")
                        @Html.TextBoxFor(m => m.corrcmpInfo.cc_number, new { autocomplete = "off", @class = "form-control", @readonly = "readonly", placeholder = "New" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblPocContact", "Purpose of Contact:")
                        @Html.DropDownListFor(m => m.corrcmpInfo.purpose_of_contact, new SelectList((IEnumerable<CTSCodeTable>)ViewData["PurposeOfContact"], "table_code", "short_description"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblPocOther", "Other")
                        @Html.TextBoxFor(m => m.corrcmpInfo.poc_other, new { autocomplete = "off", @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        <label for="TicketNo">Complaint/Inquiry from</label>
                        @Html.DropDownListFor(m => m.corrcmpInfo.cc_recdin, new SelectList((IEnumerable<CTSCodeTable>)ViewData["ComplaintEnquiry"], "table_code", "short_description"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblDoitSrNo", "DOITT SR No.")
                        @Html.TextBoxFor(m => m.corrcmpInfo.serv_req_number, new { autocomplete = "off", @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblDtRcvd", "Date Received:")
                        <div class="input-group col-md-5 dtreceived date" data-date="" data-date-format="MMMM DD YYYY" data-link-field="dtp_input2" data-link-format="MMMM DD YYYY">
                            @Html.TextBoxFor(m => m.corrcmpInfo.date_recd, new { @class = "form-control .form_datetime", placeholder = "Click to show calendar", tabindex = 3, style = "width: 220px;" })
                            <span class="input-group-addon btn-primary"><span class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblDtEntrd", "Date Entered:")
                        @Html.TextBoxFor(m => m.corrcmpInfo.date_entered, new { @class = "form-control dtEntrd", @type = "text", @Value = DateTime.Today.ToString("MMMM dd yyyy"), onkeydown = "return false", @readonly = "readonly" })
                        @*<div class="input-group date form_date col-md-5" data-date="" data-date-format="MM dd yyyy" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                @Html.TextBoxFor(m => m.corrcmpInfo.date_entered, new { @class = "form-control .form_datetime", placeholder = "Click to show calendar", tabindex = 3, style = "width: 220px;" })
                                <span class="input-group-addon btn-primary"><span class="glyphicon glyphicon-calendar"></span></span>
                            </div>*@
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        <label>Entered By:</label>
                        @{
                            var fullName = Model.userInfom.first_name + " " + Model.userInfom.last_name;
                            @Html.TextBoxFor(m => fullName, new { autocomplete = "off", @readonly = "readonly", @class = "form-control" })
                        }
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblCtDfta", "Contract with DFTA:")
                        @Html.DropDownListFor(m => m.corrcmpcontactInfo.cont_with_dfta_yn, new SelectList((IEnumerable<CTSCodeTable>)ViewData["ContractwithDFTA"], "table_code", "short_description"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblPrgmType", "If yes, select Program Type:")
                        @Html.DropDownListFor(m => m.budgetccInfo.data_value, new SelectList((IEnumerable<BudgetCodeModel>)ViewData["BudgetProgramType"], "data_value", "display_value"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblDFTAID", "If yes, select Program ID:")
                        @Html.DropDownListFor(m => m.corrcmpcontactInfo.dfta_id, new SelectList((IEnumerable<BudgetCodeModelID>)ViewData["BudgetProgramID"], "data_value", "display_value"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblZip", "If no, enter Program Name:")
                        @Html.TextBoxFor(m => m.corrcmpcontactInfo.other_site_name, new { autocomplete = "off", @class = "form-control" })
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        <label>Date of correspondence:</label>
                        <div class="input-group col-md-5 dtcc date" data-date="" data-date-format="MM dd yyyy" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                            @Html.TextBoxFor(m => m.corrcmpInfo.cc_date, new { @class = "form-control .form_datetime", placeholder = "Click to show calendar", tabindex = 3, style = "width: 220px;" })
                            <span class="input-group-addon btn-primary"><span class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        <label>Date Send to Mayor's Office</label>
                        <div class="input-group col-md-5 dtMayor date" data-date="" data-date-format="MM dd yyyy" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                            @Html.TextBoxFor(m => m.corrcmpInfo.mayor_date, new { @class = "form-control", placeholder = "Click to show calendar", tabindex = 3, style = "width: 220px;" })
                            <span class="input-group-addon btn-primary"><span class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblDueDt", "Due Date:")
                        <input type='text' id="dtduedate" class="form-control" readonly="readonly" onkeydown="return false" />
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblDueDt", "Days Remaining:")
                        <input type="text" id="dtremainging" class="form-control" readonly="readonly" onkeydown="return false" />
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblIncLocation", "Incident Location:")
                        @Html.DropDownListFor(m => m.inclocationinfo.inc_loc_type, new SelectList((IEnumerable<CTSCodeTable>)ViewData["IncidentLocation"], "table_code", "short_description"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblincloc", "Location/Address:")
                        @Html.TextBoxFor(m => m.inclocationinfo.street_add, new { autocomplete = "off", @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblincCity", "City:")
                        @Html.TextBoxFor(m => m.inclocationinfo.city, new { autocomplete = "off", @class = "form-control" })
                    </div>
                </div>
                <div class="col-md-1">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblincState", "State:")
                        @Html.TextBoxFor(m => m.inclocationinfo.state, new { autocomplete = "off", @class = "form-control" })
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblincZip", "Zip:")
                        @Html.TextBoxFor(m => m.inclocationinfo.zipcode, new { autocomplete = "off", @class = "form-control  ZipMask" })
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group form-group-sm">
                        @Html.Label("lblincCmmts", "Description of Complaint/Comment:")
                        @*@Html.TextArea("myTextArea", "This is value", new { @class = "form-control" })*@
                        @Html.TextAreaFor(m => m.ccDescInfo.cc_description_text)
                    </div>

                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        <label for="TicketNo">Complaint Status</label>
                        @Html.DropDownListFor(m => m.corrcmpInfo.cc_status, new SelectList((IEnumerable<CTSCodeTable>)ViewData["ComplaintStatus"], "table_code", "short_description"), "Select One", new { @class = "form-control" })
                    </div>
                </div>
                <div class="col-sm-6 col-md-3">
                    <div class="form-group form-group-sm">
                        <div id="resStatus" style="display:none">
                            @Html.Label("lblResolution", "Resolution Status:")
                            @Html.DropDownListFor(m => m.corrcmpInfo.resolution_status, new SelectList((IEnumerable<CTSCodeTable>)ViewData["ResolutionStatus"], "table_code", "short_description"), "Select One", new { @class = "form-control" })
                        </div>
                    </div>
                </div>
                <div class="row margin-top margin-bottom">
                    <div style="float:right" class="col-md-3">
                        <input type="submit" id="btnsaveCC" class="btn btn-primary btn-sm pull-right" value="Save" formaction="TrackingInfo">
                    </div>
                </div>
            </div>

            @if (Session["ccnum"] != null)
            {

                @************************ Tabs for Complainants / Complaint / Referral / Attachments ************************@
                <div class="margin-top" id="Tabs">
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active"><a href="#ComplaintInquirer" aria-controls="home" role="tab" data-toggle="tab">Complainant / Inquirer</a></li>
                        @*<li role="presentation"><a href="#ComplaintIncident" aria-controls="ComplaintIncident" role="tab" data-toggle="tab">Details</a></li>*@
                        <li role="presentation"><a href="#ReferralResolution" aria-controls="ReferralResolution" role="tab" data-toggle="tab">Referral</a></li>
                        <li role="presentation"><a href="#Resolution" aria-controls="Resolution" role="tab" data-toggle="tab">Resolution</a></li>
                        <li role="presentation"><a href="#Attachments" aria-controls="Attachments" role="tab" data-toggle="tab">Attachments</a></li>
                    </ul>

                    <!-- Tab panes -->
                    <div class="tab-content">
                        @************************ Tab Complaint / Inquirer ************************@
                        <div role="tabpanel" class="tab-pane active" id="ComplaintInquirer">
                            @Html.Partial("ComplaintPV")
                        </div>
                        @************************ Details ************************@
                        @*<div role="tabpanel" class="tab-pane" id="ComplaintIncident">
                                @Html.Partial("DetailsPV")
                            </div>*@
                        @************************ Tab Referral ************************@
                        <div role="tabpanel" class="tab-pane" id="ReferralResolution">
                            @Html.Partial("ReferralPV")
                        </div>
                        @************************ Tab Resolution ************************@
                        <div role="tabpanel" class="tab-pane" id="Resolution">
                            @Html.Partial("ResolutionPV")
                        </div>
                        @************************ Tab Attachments ************************@
                        <div role="tabpanel" class="tab-pane" id="Attachments">
                            @Html.Partial("AttachmentsPV")
                        </div>
                    </div>
                    <!-- End of Tab panes -->



                </div>
                @************************ End of Tabs for Complainants / Complaint / Referral / Attachments ************************@
            }
        </div>
                            }

</body>
@Scripts.Render("~/bundles/jquery")
<script defer="defer">
    $(function () {
        dateRange();
    });
    function dateRange() {
        var date = new Date();
        var today = new Date(date.getFullYear(), date.getMonth(), date.getDate());
        var daysback = new Date(date.getFullYear(), date.getMonth(), date.getDate() - 30);
        var dtentrdinput = $('.dtEntrd').val();
        //New ticket
        var myLength = $("#corrcmpInfo_cc_number").val().length;
        if (myLength == 0) {
            $('.dtreceived').datepicker({
                autoclose: true,
                endDate: new Date(),
                format: 'MM dd yyyy'
            }).datepicker('setDate', today);


            $('.dtReferral').datepicker({
                autoclose: true,
                startDate: today,
                format: 'MM dd yyyy'
            }).datepicker('setDate', today);
            $('.dtresolved').datepicker({
                autoclose: true,
                startDate: today,
                format: 'MM dd yyyy'
            }).datepicker('setDate', today);

            //mayor date
            $("#corrcmpInfo_mayor_date").attr("disabled", "disabled");

            var dtrecevide = $('.dtreceived').datepicker("getDate");
            //due date
            var dtrcdfordue = new Date(dtrecevide);
            dtrcdfordue.setDate(dtrcdfordue.getDate() + 14);
            var dueDate = moment(dtrcdfordue).format("MMMM DD YYYY");
            $('#dtduedate').val(dueDate);
            //days remaining
            var startDate = moment(today);
            var endDate = moment(dueDate);
            var days = endDate.diff(startDate, 'days');
            var daysRemaining = days + " days";
            $('#dtremainging').val(daysRemaining);

            $('.dtreceived').change(function () {
                if ($('#budgetccInfo_data_value').val() != 'ABUSE') {
                    //due date
                    var dtrecevide = $('#corrcmpInfo_date_recd').val();
                    var dtrcdfordue = new Date(dtrecevide);
                    dtrcdfordue.setDate(dtrcdfordue.getDate() + 14);
                    var dueDate = moment(dtrcdfordue).format("MMMM DD YYYY");
                    $('#dtduedate').val(dueDate);
                    //days remaining
                    var startDate = moment(today);
                    var endDate = moment(dueDate);
                    var days = endDate.diff(startDate, 'days');
                    var daysRemaining = days + " days";
                    $('#dtremainging').val(daysRemaining);
                    //cc date
                    console.log(dtrecevide);
                    $('.dtcc').datepicker({
                        autoclose: true,
                        endDate: dtrecevide,
                        format: 'MM dd yyyy'
                    }).datepicker('setDate', dtrecevide);
                }
                else if ($('#budgetccInfo_data_value').val() == 'ABUSE') {
                    var dtrcdfordueAbuse = new Date(today);
                    dtrcdfordueAbuse.setDate(dtrcdfordueAbuse.getDate() + 5);
                    var dueDateAbuse = moment(dtrcdfordueAbuse).format("MMMM DD YYYY");
                    $('#dtduedate').val(dueDateAbuse);
                    //days remaining
                    var startDate = moment(today);
                    var endDate = moment(dueDateAbuse);
                    var days = endDate.diff(startDate, 'days');
                    var daysRemaining = days + " days";
                    $('#dtremainging').val(daysRemaining);
                }
            });

            $('#budgetccInfo_data_value').on('change', function () {
                if (this.value == 'ABUSE') {
                    var dtrcdfordueAbuse = new Date(today);
                    dtrcdfordueAbuse.setDate(dtrcdfordueAbuse.getDate() + 5);
                    var dueDateAbuse = moment(dtrcdfordueAbuse).format("MMMM DD YYYY");
                    $('#dtduedate').val(dueDateAbuse);
                    //days remaining
                    var startDate = moment(today);
                    var endDate = moment(dueDateAbuse);
                    var days = endDate.diff(startDate, 'days');
                    var daysRemaining = days + " days";
                    $('#dtremainging').val(daysRemaining);
                }
                else {
                    var dtrecevide = $('#corrcmpInfo_date_recd').val();
                    var dtrcdfordue = new Date(dtrecevide);
                    dtrcdfordue.setDate(dtrcdfordue.getDate() + 14);
                    var dueDate = moment(dtrcdfordue).format("MMMM DD YYYY");
                    $('#dtduedate').val(dueDate);
                    //days remaining
                    var startDate = moment(today);
                    var endDate = moment(dueDate);
                    var days = endDate.diff(startDate, 'days');
                    var daysRemaining = days + " days";
                    $('#dtremainging').val(daysRemaining);
                }
            })

        }

        var myLength = $("#corrcmpInfo_cc_number").val().length;
        if (myLength != 0) {


            var dtrec1 = $('#corrcmpInfo_date_recd').val();
            dtrec1 = moment(dtrec1).format("MMMM DD YYYY");
            $('#corrcmpInfo_date_recd').val(dtrec1);

            var dtcc1 = $('#corrcmpInfo_cc_date').val();
            dtcc1 = moment(dtcc1).format("MMMM DD YYYY");
            $('#corrcmpInfo_cc_date').val(dtcc1);

            var dtrecevide = $('#corrcmpInfo_date_recd').val();
            var startDate = moment(dtrecevide);
            var endDate = moment(dueDate);
            var days = endDate.diff(startDate, 'days');
            var daysRemaining = days + " days";
            $('#dtremainging').val(daysRemaining);
            $('.dtreceived').datepicker({
                autoclose: true,
                endDate: new Date(),
                format: 'MMMM DD YYYY'
            });
            $('.dtcc').datepicker({
                autoclose: true,
                startDate: today,
                format: 'MMMM DD YYYY'
            });
            $('.dtMayor').datepicker({
                autoclose: true,
                startDate: today,
                format: 'MMMM DD YYYY'
            })
            if ($('#corrcmpInfo_resolution_status').val() == "3") {
                $("#corrcmpInfo_mayor_date").removeAttr("disabled");
                $('.dtMayor').datepicker({
                    autoclose: true,
                    startDate: today,
                    format: 'MM dd yyyy'
                }).datepicker('setDate', today);
            }
            //due date
            var dtrecevide = $('#corrcmpInfo_date_recd').val();
            var dtrcdfordue = new Date(dtrecevide);
            dtrcdfordue.setDate(dtrcdfordue.getDate() + 14);
            var dueDate = moment(dtrcdfordue).format("MMMM DD YYYY");
            $('#dtduedate').val(dueDate);
            //days remaining
            var startDate = moment(today);
            var endDate = moment(dueDate);
            var days = endDate.diff(startDate, 'days');
            var daysRemaining = days + " days";
            $('#dtremainging').val(daysRemaining);
            //referral date
            if ($('#referralInfom_referred_to_group').val() == "" || $('#referralInfom_referred_to_group').val() == "Select One") {
                $('.dtReferral').datepicker({
                    autoclose: true,
                    startDate: today,
                    format: 'MM dd yyyy'
                }).datepicker('setDate', today);
            }
            //resolution date
            if ($('#referralInfom_cc_handled_by').val() != "") {
                $('.dtresolved').datepicker({
                    autoclose: true,
                    startDate: today,
                    format: 'MM dd yyyy'
                }).datepicker('setDate', today);
            }
            //get referal date
            if ($('#referralInfom_referred_to_group').val() != "" || $('#referralInfom_referred_to_group').val() != "Select One") {
                var dtrefer = $('#referralInfom_referal_date').val();
                dtrefer = moment(dtrefer).format("MMMM DD YYYY");
                $('#referralInfom_referal_date').val(dtrefer);
            }
            //get resolution date
            //if ($('#referralInfom_cc_handled_by').val() == "" || $('#referralInfom_cc_handled_by').val() == "Select One") {
            //    var dtresoltion = $('#resolutionInfom_date_resolved').val();
            //    dtresoltion = moment(dtresoltion).format("MMMM DD YYYY");
            //    $('#resolutionInfom_date_resolved').val(dtresoltion);
            //}
        }

        $('.icon-arrow-left').addClass('glyphicon glyphicon-chevron-left');
        $('.icon-arrow-right').addClass('glyphicon glyphicon-chevron-right');

        //Contract with DFTA and budget fields
        $("#budgetccInfo_data_value").attr("disabled", "disabled");
        $("#corrcmpcontactInfo_dfta_id").attr("disabled", "disabled");
        $("#corrcmpcontactInfo_other_site_name").attr("disabled", "disabled");
        $('#corrcmpcontactInfo_cont_with_dfta_yn').on('change', function () {
            if (this.value == '1') {
                $("#corrcmpcontactInfo_other_site_name").attr("disabled", "disabled");
                $("#budgetccInfo_data_value").removeAttr("disabled");
                $("#corrcmpcontactInfo_dfta_id").removeAttr("disabled");
                $('#budgetccInfo_data_value').show();
                $("#budgetccInfo_data_value").prop('required', true);
                $("#corrcmpcontactInfo_dfta_id").prop('required', true);
                $("#budgetccInfo_data_value").focus();
            }
            else if (this.value == '2') {
                $("#budgetccInfo_data_value").attr("disabled", "disabled");
                $("#corrcmpcontactInfo_dfta_id").attr("disabled", "disabled");
                $("#corrcmpcontactInfo_other_site_name").removeAttr("disabled");
                $('#corrcmpcontactInfo_other_site_name').show();
                $("#corrcmpcontactInfo_other_site_name").prop('required', true);
                $("#corrcmpcontactInfo_other_site_name").focus();
            }
        })
        //$('#budgetccInfo_data_value').on('change', function () {
        //    if ($('#corrcmpcontactInfo_dfta_id').val() == 0 || $('#corrcmpcontactInfo_dfta_id').val() == null || $('#corrcmpcontactInfo_dfta_id').val() == "Select One") {
        //        return false;
        //        $("#corrcmpcontactInfo_dfta_id").prop('required', true);
        //    }
        //})


        if ($('#corrcmpcontactInfo_cont_with_dfta_yn').val() == "1") {
            $("#budgetccInfo_data_value").removeAttr("disabled");
            $("#corrcmpcontactInfo_dfta_id").removeAttr("disabled");
            $("#corrcmpcontactInfo_other_site_name").attr("disabled", "disabled");
        }
        if ($('#corrcmpcontactInfo_cont_with_dfta_yn').val() == "2") {
            $("#budgetccInfo_data_value").attr("disabled", "disabled");
            $("#corrcmpcontactInfo_dfta_id").attr("disabled", "disabled");
            $("#corrcmpcontactInfo_other_site_name").removeAttr("disabled");
        }
    }
</script>

<script type="text/javascript">
    $(function () {
        $("#divSearchID").hide();
        var myLength = $("#corrcmpInfo_cc_number").val().length;
        if (myLength != 0) {
            //Disable general fields once the ticket is created
            $("#resStatus").show();
            $("#corrcmpInfo_resolution_status").attr("disabled", "disabled");
            if($("#referralInfom_referral_status").val() == "1") {
                $("#btnsaveCC").hide();
            $("#corrcmpInfo_mayor_date").attr("disabled", "disabled");
            $("#corrcmpInfo_poc_other").attr("disabled", "disabled");
            $("#corrcmpInfo_purpose_of_contact").attr("disabled", "disabled");
            $("#corrcmpInfo_cc_recdin").attr("disabled", "disabled");
            $("#corrcmpInfo_cc_status").attr("disabled", "disabled");
            $("#corrcmpInfo_date_recd").attr("disabled", "disabled");
            $("#corrcmpInfo_cc_date").attr("disabled", "disabled");
            $("#inclocationinfo_inc_loc_type").attr("disabled", "disabled");
            $("#inclocationinfo_street_add").attr("disabled", "disabled");
            $("#inclocationinfo_city").attr("disabled", "disabled");
            $("#inclocationinfo_state").attr("disabled", "disabled");
            $("#inclocationinfo_zipcode").attr("disabled", "disabled");
        }
            //Referral tab referred status and resolution should handle by dropdowns data
            if ($("#corrcmpInfo_resolution_status").val() == "1") {
                $("#divrefsts").hide();
                $("#divrefres").hide();
                $("#divrefrjc").hide();
            }
            else if ($("#corrcmpInfo_resolution_status").val() == "2") {
              //  $("#referralInfom_referred_to_unit").attr("disabled", "disabled");
                $("#referralInfom_referred_to_unit").attr('readonly', 'readonly');
            }

        }
        else if (myLength == 0) {
            //Purpose of contact and Complaint/Inquiry from dropdown conditions
            $("#corrcmpInfo_poc_other").attr("disabled", "disabled");
            $("#corrcmpInfo_serv_req_number").attr("disabled", "disabled");
            $('#corrcmpInfo_purpose_of_contact').on('change', function () {
                if (this.value == '4') {
                    $("#corrcmpInfo_poc_other").removeAttr("disabled");
                    $('#corrcmpInfo_poc_other').show();
                    $("#corrcmpInfo_poc_other").prop('required', true);
                    $("#corrcmpInfo_poc_other").focus();
                }
                else {
                    $("#corrcmpInfo_poc_other").attr("disabled", "disabled").prop('required', false);
                }
            })
            $('#corrcmpInfo_cc_recdin').on('change', function () {
                if (this.value == '1') {
                    $("#corrcmpInfo_serv_req_number").removeAttr("disabled");
                    $('#corrcmpInfo_serv_req_number').show();
                    $("#corrcmpInfo_serv_req_number").prop('required', true);
                    $("#corrcmpInfo_serv_req_number").focus();
                }
                else {
                    $("#corrcmpInfo_serv_req_number").attr("disabled", "disabled").prop('required', false);
                }
            })
            if ($('#corrcmpInfo_purpose_of_contact').val() == "" || $('#corrcmpInfo_purpose_of_contact').val() == "Select One") {
                $("#corrcmpInfo_purpose_of_contact").prop('required', true);
            }
            if ($('#corrcmpInfo_cc_recdin').val() == "" || $('#corrcmpInfo_cc_recdin').val() == "Select One") {
                $("#corrcmpInfo_cc_recdin").prop('required', true);
            }
            if ($('#corrcmpInfo_cc_status').val() == "" || $('#corrcmpInfo_cc_status').val() == "Select One") {
                $("#corrcmpInfo_cc_status").prop('required', true);
            }
        }



        $("#btn_addnewreferral").click(function () {
            alert("button");
            $("#referralInfom_comments").val("");
            $("#referralInfom_referred_to_group").val("--select--");
            $("#referralInfom_referral_status").val("--select--");
            return true;
        });

        //Get Budget dropdown values
        $('#budgetccInfo_data_value').on('change', function () {
            var stateId = $("#budgetccInfo_data_value").val();
            var url = "/Tracking/FillModel?value=" + stateId;
            $.ajax({
                type: 'GET',
                url: url,
                datatype: 'application/json',
                contentType: 'application/json',
                data: JSON.stringify({ stateId: +stateId }),
                success: function (result) {
                    $("#corrcmpcontactInfo_dfta_id").html("");
                    $("#corrcmpcontactInfo_dfta_id").append('<option value="0"></option>');
                    $.each(result, function (i, Arrayvalue) {
                        $("#corrcmpcontactInfo_dfta_id").append($('<option></option>').val(Arrayvalue.Text).html(Arrayvalue.Value))
                    })
                },
                error: function () {
                },
            });
        })

        //Get Group dropdown values based on unit
        $('#referralInfom_referred_to_unit').on('change', function () {
            var stateId = $("#referralInfom_referred_to_unit option:selected").text();
            var url = "/Tracking/FillGroup?value=" + stateId;
            $.ajax({
                type: 'GET',
                url: url,
                datatype: 'application/json',
                contentType: 'application/json',
                data: JSON.stringify({ stateId: +stateId }),
                success: function (result) {
                    $("#referralInfom_referred_to_group").html("");
                    $("#referralInfom_referred_to_group").append('<option value="0"></option>');
                    $.each(result, function (i, Arrayvalue) {
                        $("#referralInfom_referred_to_group").append($('<option></option>').val(Arrayvalue.Text).html(Arrayvalue.Value))
                    })
                },
                error: function () {
                },
            });
        })

        //Get Resolutionhandled by dropdown values based on group
        $('#referralInfom_referred_to_group').on('change', function () {
            var stateId = $("#referralInfom_referred_to_group option:selected").text();
            var url = "/Tracking/FillGroupUsers?value=" + stateId;
            $.ajax({
                type: 'GET',
                url: url,
                datatype: 'application/json',
                contentType: 'application/json',
                data: JSON.stringify({ stateId: +stateId }),
                success: function (result) {
                    $("#referralInfom_cc_handled_by").html("");
                    $("#referralInfom_cc_handled_by").append('<option value="0"></option>');
                    $.each(result, function (i, Arrayvalue) {
                        $("#referralInfom_cc_handled_by").append($('<option></option>').val(Arrayvalue.Text).html(Arrayvalue.Value))
                    })
                },
                error: function () {
                },
            });
        })

        //Get incident location dropdown based on dftaId(program ID)
        $('#corrcmpcontactInfo_dfta_id').on('change', function () {
            var programtype = $("#corrcmpcontactInfo_dfta_id").val();
            var url = "/Tracking/FillIncDetails?value=" + programtype;
            $.ajax({
                type: 'GET',
                url: url,
                datatype: 'application/json',
                contentType: 'application/json',
                data: JSON.stringify({ programtype: +programtype }),
                success: function (result) {
                    $("#inclocationinfo_inc_loc_type").val(result);
                },
                error: function () {
                    alert("Whooaaa! Something went wrong..")
                },
            });
        })

        //Get incident location details like address, city, state and zip based on dftaId(program ID)
        $('#corrcmpcontactInfo_dfta_id').on('change', function () {
            var programtype = $("#corrcmpcontactInfo_dfta_id").val();
            var url = "/Tracking/FillIncAddDetails?value=" + programtype;
            $.ajax({
                type: 'GET',
                url: url,
                datatype: 'application/json',
                contentType: 'application/json',
                data: JSON.stringify({ programtype: +programtype }),
                success: function (result) {
                    $("#inclocationinfo_street_add").val(result.address);
                    $("#inclocationinfo_city").val(result.pgm_city);
                    $("#inclocationinfo_state").val(result.pgm_state);
                    $("#inclocationinfo_zipcode").val(result.pgm_zip);
                },
                error: function () {
                    alert("Whooaaa! Something went wrong..")
                },
            });
        })

    });

    $(document).ready(function () {
        $(".PhoneMask").mask("999-999-9999");
        $(".ZipMask").mask("99999");
    });
</script>


<script type="text/javascript">
    $(function () {
        var tabName = $("[id*=hiddenvalue]").val() != "" ? $("[id*=hiddenvalue]").val() : "ComplaintInquirer";
        $('#Tabs a[href="#' + tabName + '"]').tab('show');
        $("#Tabs a").click(function () {
            $("[id*=hiddenvalue]").val($(this).attr("href").replace("#", ""));
        });
    });
</script>



